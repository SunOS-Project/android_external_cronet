From e7f653a2f54944d209009587c5e62567333fa1b1 Mon Sep 17 00:00:00 2001
From: Dan Stahr <danstahr@google.com>
Date: Tue, 3 Jan 2023 16:33:27 +0000
Subject: [PATCH 1/1] Remove Java fallback implementation of Cronet APIs.

Test: m

Change-Id: Ie119db4827f3e4029b244a6e7b3337f8b38d7b07
---
 components/cronet/android/BUILD.gn | 54 ------------------------------
 1 file changed, 54 deletions(-)

diff --git a/components/cronet/android/BUILD.gn b/components/cronet/android/BUILD.gn
index c26bf05728573..c7f73c2cf22c2 100644
--- a/components/cronet/android/BUILD.gn
+++ b/components/cronet/android/BUILD.gn
@@ -329,39 +329,6 @@ android_library("cronet_impl_common_base_java") {
   srcjar_deps = cronet_impl_common_java_srcjar_deps
 }
 
-# cronet_impl_java_util_java.jar - Classes shared between Java Cronet implementations.
-android_library("cronet_impl_java_util_java") {
-  sources = [
-    "java/src/org/chromium/net/impl/JavaUploadDataSinkBase.java",
-    "java/src/org/chromium/net/impl/JavaUrlRequestUtils.java",
-  ]
-
-  deps = [
-    ":cronet_api_java",
-    "//third_party/androidx:androidx_annotation_annotation_java",
-  ]
-}
-
-# cronet_impl_platform_base_java.jar - Java platform based implementation of the Cronet engine.
-android_library("cronet_impl_platform_base_java") {
-  sources = [
-    "java/src/org/chromium/net/impl/InputStreamChannel.java",
-    "java/src/org/chromium/net/impl/JavaCronetEngine.java",
-    "java/src/org/chromium/net/impl/JavaCronetEngineBuilderImpl.java",
-    "java/src/org/chromium/net/impl/JavaCronetProvider.java",
-    "java/src/org/chromium/net/impl/JavaUrlRequest.java",
-  ]
-
-  deps = [
-    ":cronet_api_java",
-    ":cronet_impl_common_base_java",
-    ":cronet_impl_java_util_java",
-    "//net/android:net_thread_stats_uid_java",
-    "//third_party/android_deps:com_google_code_findbugs_jsr305_java",
-    "//third_party/androidx:androidx_annotation_annotation_java",
-  ]
-}
-
 # cronet_impl_fake_base_java.jar - Fake implementation of Cronet.
 android_library("cronet_impl_fake_base_java") {
   sources = [
@@ -456,7 +423,6 @@ java_group("cronet_impl_all_java") {
   deps = [
     ":cronet_impl_common_base_java",
     ":cronet_impl_native_base_java",
-    ":cronet_impl_platform_base_java",
   ]
 }
 
@@ -717,12 +683,6 @@ jar_src("jar_cronet_impl_common_java_source") {
   jar_path = "$_package_dir/cronet_impl_common_java-src.jar"
 }
 
-jar_src("jar_cronet_impl_platform_java_source") {
-  src_search_dirs = [ "java/src" ]
-  source_deps = [ ":cronet_impl_platform_base_java" ]
-  jar_path = "$_package_dir/cronet_impl_platform_java-src.jar"
-}
-
 jar_src("jar_cronet_impl_fake_java_source") {
   src_search_dirs = [ "fake/java" ]
   source_deps = [ ":cronet_impl_fake_base_java" ]
@@ -778,11 +738,6 @@ repackage_jars("repackage_api") {
   deps = [ ":cronet_api_java" ]
 }
 
-repackage_jars("repackage_platform") {
-  output = "$_package_dir/cronet_impl_platform_java.jar"
-  deps = [ ":cronet_impl_platform_base_java" ]
-}
-
 repackage_jars("repackage_fake") {
   output = "$_package_dir/cronet_impl_fake_java.jar"
   deps = [ ":cronet_impl_fake_base_java" ]
@@ -1034,7 +989,6 @@ android_library("cronet_fake_javatests") {
            ":cronet_common_javatests",
            ":cronet_impl_common_base_java",
            ":cronet_impl_fake_base_java",
-           ":cronet_impl_platform_base_java",
            ":cronet_test_apk_java",
            "//base:base_java_test_support",
            "//third_party/android_deps:guava_android_java",
@@ -1226,7 +1180,6 @@ instrumentation_test_apk(
   deps = [
            ":cronet_api_java",
            ":cronet_impl_common_base_java",
-           ":cronet_impl_platform_base_java",
            ":cronet_smoketests_platform_only_apk_resources",
            "//base:base_java_test_support",
            "//third_party/android_sdk:android_test_base_java",
@@ -1262,7 +1215,6 @@ instrumentation_test_apk(
            ":cronet_api_java",
            ":cronet_combine_proguard_flags",
            ":cronet_impl_common_base_java",
-           ":cronet_impl_platform_base_java",
            ":cronet_test_apk_java",
            ":cronet_test_apk_resources",
            "//base:base_java",
@@ -1592,7 +1544,6 @@ copy("cronet_package_copy") {
     ":cronet_combine_proguard_flags",
     ":cronet_impl_common_base_java",
     ":cronet_impl_fake_base_java",
-    ":cronet_impl_platform_base_java",
   ]
 }
 
@@ -1709,7 +1660,6 @@ action("api_static_checks") {
   outputs = [ "$target_gen_dir/$target_name.stamp" ]
   _api_jar = "$target_out_dir/cronet_api_java.processed.jar"
   _common_jar = "$target_out_dir/cronet_impl_common_base_java.processed.jar"
-  _platform_jar = "$target_out_dir/cronet_impl_platform_base_java.processed.jar"
   _native_jar = "$target_out_dir/cronet_impl_native_base_java.processed.jar"
   args = [
     "--api_jar",
@@ -1717,8 +1667,6 @@ action("api_static_checks") {
     "--impl_jar",
     rebase_path(_common_jar, root_build_dir),
     "--impl_jar",
-    rebase_path(_platform_jar, root_build_dir),
-    "--impl_jar",
     rebase_path(_native_jar, root_build_dir),
     "--stamp",
     rebase_path(outputs[0], root_build_dir),
@@ -1727,12 +1675,10 @@ action("api_static_checks") {
     ":cronet_api_java",
     ":cronet_impl_common_base_java",
     ":cronet_impl_native_base_java",
-    ":cronet_impl_platform_base_java",
   ]
   inputs = [
     _api_jar,
     _common_jar,
-    _platform_jar,
     _native_jar,
     "//components/cronet/tools/update_api.py",
   ]
-- 
2.41.0.694.ge786442a9b-goog

